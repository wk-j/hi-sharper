function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){window.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH;a=window;b=a.HiSharper=a.HiSharper||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.UI=d.UI||{};f=e.Var=e.Var||{};g=d.Operators=d.Operators||{};h=d.Unchecked=d.Unchecked||{};i=a.System=a.System||{};j=i.Guid=i.Guid||{};k=d.Obj=d.Obj||{};l=d.List=d.List||{};m=l.T=l.T||{};n=e.ListModel=e.ListModel||{};o=d.Arrays=d.Arrays||{};p=e.Templating=e.Templating||{};q=p.Runtime=p.Runtime||{};r=q.Server=q.Server||{};s=r.TemplateInstance=r.TemplateInstance||{};t=r.Handler=r.Handler||{};u=a.HiSharper_Templates=a.HiSharper_Templates||{};v=e.ConcreteVar=e.ConcreteVar||{};w=e.Snap=e.Snap||{};x=a.StartupCode$HiSharper$Client=a.StartupCode$HiSharper$Client||{};y=d.Collections=d.Collections||{};z=y.Dictionary=y.Dictionary||{};A=y.HashSet=y.HashSet||{};B=q.Client=q.Client||{};C=d.Seq=d.Seq||{};D=d.JavaScript=d.JavaScript||{};E=D.Pervasives=D.Pervasives||{};F=e.Doc=e.Doc||{};G=e.Abbrev=e.Abbrev||{};H=G.Fresh=G.Fresh||{};I=e.View=e.View||{};J=y.DictionaryUtil=y.DictionaryUtil||{};K=d.Enumerator=d.Enumerator||{};L=a.Object;M=K.T=K.T||{};N=a.EventTarget;O=a.Node;P=e.DomUtility=e.DomUtility||{};Q=d.Numeric=d.Numeric||{};R=D.JSModule=D.JSModule||{};S=e.Docs=e.Docs||{};T=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};U=G.Mailbox=G.Mailbox||{};V=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};W=e.Storage=e.Storage||{};X=e.DocElemNode=e.DocElemNode||{};Y=a.CharacterData;Z=a.StartupCode$WebSharper_UI$Doc_Client=a.StartupCode$WebSharper_UI$Doc_Client||{};_0=e.Attrs=e.Attrs||{};_1=e.CheckedInput=e.CheckedInput||{};_2=e.AttrModule=e.AttrModule||{};_3=e.AttrProxy=e.AttrProxy||{};_4=d.Slice=d.Slice||{};_5=d.Strings=d.Strings||{};_6=e.Array=e.Array||{};_7=e.Elt=e.Elt||{};_8=e.Client=e.Client||{};_9=_8.Docs=_8.Docs||{};_=_9.RunState=_9.RunState||{};$=_9.NodeSet=_9.NodeSet||{};ba=e.An=e.An||{};bb=y.HashSetUtil=y.HashSetUtil||{};bc=W.ArrayStorage=W.ArrayStorage||{};bd=_8.Attrs=_8.Attrs||{};be=bd.Dyn=bd.Dyn||{};bf=e.String=e.String||{};bg=e.Updates=e.Updates||{};bh=d.Concurrency=d.Concurrency||{};bi=e.Anims=e.Anims||{};bj=e.AppendList=e.AppendList||{};bk=d.Char=d.Char||{};bl=e.DynamicAttrNode=e.DynamicAttrNode||{};bm=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bn=bh.AsyncBody=bh.AsyncBody||{};bo=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bp=bh.CT=bh.CT||{};bq=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};br=G.HashSet=G.HashSet||{};bs=bh.Scheduler=bh.Scheduler||{};bt=d.CancellationTokenSource=d.CancellationTokenSource||{};bu=e.Easing=e.Easing||{};bv=d.OperationCanceledException=d.OperationCanceledException||{};bw=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bx=d.Lazy=d.Lazy||{};by=_9.DomNodes=_9.DomNodes||{};bz=d.Queue=d.Queue||{};bA=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bB=bA.LazyRecord=bA.LazyRecord||{};bC=a.Math;bD=a.IntelliFactory;bE=bD&&bD.Runtime;bF=a.console;bG=a.jQuery;bH=a.Date;c.Main=function(){var bI,bJ,bK,bL,bM,bN;function bO(bP){c.People().Append(bI.Get());bI.Set("");}bI=f.Create$1("");F.RunById("main",(bJ=(bK=[null],[bK,(bL=j.NewGuid(),a.String(bL)),new m({$:1,$0:{$:5,$0:"add",$1:true,$2:function(bP){return function(bQ){return bO({Vars:bK[0],Target:bP,Event:bQ});};}},$1:new m({$:1,$0:{$:7,$0:"name",$1:bI},$1:new m({$:1,$0:{$:0,$0:"listcontainer",$1:F.Convert(function(bP){var bQ,bR,bS;return(bQ=[null],(bR=t.CompleteHoles((bS=j.NewGuid(),a.String(bS)),new m({$:1,$0:{$:1,$0:"name",$1:bP},$1:m.Empty}),[]),(bQ[0]=new s.New(bR[1],u.listitem(bR[0])),bQ[0]))).get_Doc();},c.People().v)},$1:m.Empty})})})]),(bM=bJ[0],(bN=t.CompleteHoles(bJ[1],bJ[2],[["name",0]]),(bM[0]=new s.New(bN[1],u.main(bN[0])),bM[0])))).get_Doc());};c.People=function(){x.$cctor();return x.People;};f.Create$1=function(bI){return new v.New(false,w.New({$:2,$0:bI,$1:[]}),bI);};g.FailWith=function(bI){throw a.Error(bI);};g.KeyValue=function(bI){return[bI.K,bI.V];};h.Equals=function(bI,bJ){var bK,bL,bM,bN;if(bI===bJ)return true;else{bK=typeof bI;if(bK=="object"){if(bI===null||bI===void 0||bJ===null||bJ===void 0)return false;else if("Equals"in bI)return bI.Equals(bJ);else if(bI instanceof a.Array&&bJ instanceof a.Array)return h.arrayEquals(bI,bJ);else if(bI instanceof a.Date&&bJ instanceof a.Date)return h.dateEquals(bI,bJ);else{bL=[true];for(var bO in bI)if(function(bP){bL[0]=!bI.hasOwnProperty(bP)||bJ.hasOwnProperty(bP)&&h.Equals(bI[bP],bJ[bP]);return!bL[0];}(bO))break;if(bL[0]){for(var bP in bJ)if(function(bQ){bL[0]=!bJ.hasOwnProperty(bQ)||bI.hasOwnProperty(bQ);return!bL[0];}(bP))break;}return bL[0];}}else return bK=="function"&&("$Func"in bI?bI.$Func===bJ.$Func&&bI.$Target===bJ.$Target:"$Invokes"in bI&&"$Invokes"in bJ&&h.arrayEquals(bI.$Invokes,bJ.$Invokes));}};h.Hash=function(bI){var bJ;bJ=typeof bI;return bJ=="function"?0:bJ=="boolean"?bI?1:0:bJ=="number"?bI:bJ=="string"?h.hashString(bI):bJ=="object"?bI==null?0:bI instanceof a.Array?h.hashArray(bI):h.hashObject(bI):0;};h.arrayEquals=function(bI,bJ){var bK,bL;if(o.length(bI)===o.length(bJ)){bK=true;bL=0;while(bK&&bL<o.length(bI)){!h.Equals(o.get(bI,bL),o.get(bJ,bL))?bK=false:void 0;bL=bL+1;}return bK;}else return false;};h.dateEquals=function(bI,bJ){return bI.getTime()===bJ.getTime();};h.hashString=function(bI){var bJ,bK,bL;if(bI===null)return 0;else{bJ=5381;for(bK=0,bL=bI.length-1;bK<=bL;bK++)bJ=h.hashMix(bJ,bI[bK].charCodeAt());return bJ;}};h.hashArray=function(bI){var bJ,bK,bL;bJ=-34948909;for(bK=0,bL=o.length(bI)-1;bK<=bL;bK++)bJ=h.hashMix(bJ,h.Hash(o.get(bI,bK)));return bJ;};h.hashObject=function(bI){var bJ,bK;if("GetHashCode"in bI)return bI.GetHashCode();else{bJ=[0];for(var bL in bI)if(function(bM){bJ[0]=h.hashMix(h.hashMix(bJ[0],h.hashString(bM)),h.Hash(bI[bM]));return false;}(bL))break;return bJ[0];}};h.hashMix=function(bI,bJ){return(bI<<5)+bI+bJ;};h.Compare=function(bI,bJ){var bK,bL,bM,bN,bO,bP;if(bI===bJ)return 0;else{bL=typeof bI;switch(bL=="function"?1:bL=="boolean"?2:bL=="number"?2:bL=="string"?2:bL=="object"?3:0){case 0:return typeof bJ=="undefined"?0:-1;break;case 1:return g.FailWith("Cannot compare function values.");break;case 2:return bI<bJ?-1:1;break;case 3:if(bI===null)bM=-1;else if(bJ===null)bM=1;else if("CompareTo"in bI)bM=bI.CompareTo(bJ);else if("CompareTo0"in bI)bM=bI.CompareTo0(bJ);else if(bI instanceof a.Array&&bJ instanceof a.Array)bM=h.compareArrays(bI,bJ);else if(bI instanceof a.Date&&bJ instanceof a.Date)bM=h.compareDates(bI,bJ);else{bN=[0];for(var bQ in bI)if(function(bR){return!bI.hasOwnProperty(bR)?false:!bJ.hasOwnProperty(bR)?(bN[0]=1,true):(bN[0]=h.Compare(bI[bR],bJ[bR]),bN[0]!==0);}(bQ))break;if(bN[0]===0){for(var bR in bJ)if(function(bS){return!bJ.hasOwnProperty(bS)?false:!bI.hasOwnProperty(bS)&&(bN[0]=-1,true);}(bR))break;}bM=bN[0];}return bM;break;}}};h.compareArrays=function(bI,bJ){var bK,bL;if(o.length(bI)<o.length(bJ))return -1;else if(o.length(bI)>o.length(bJ))return 1;else{bK=0;bL=0;while(bK===0&&bL<o.length(bI)){bK=h.Compare(o.get(bI,bL),o.get(bJ,bL));bL=bL+1;}return bK;}};h.compareDates=function(bI,bJ){return h.Compare(bI.getTime(),bJ.getTime());};j.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(bI){var bJ,bK;bJ=bC.random()*16|0;bK=bI=="x"?bJ:bJ&3|8;return bK.toString(16);});};k=d.Obj=bE.Class({Equals:function(bI){return this===bI;},GetHashCode:function(){return -1;}},null,k);m=l.T=bE.Class({GetEnumerator:function(){return new M.New(this,null,function(bI){var bJ;bJ=bI.s;return bJ.$==0?false:(bI.c=bJ.$0,bI.s=bJ.$1,true);},void 0);},GetEnumerator0:function(){return K.Get(this);}},null,m);m.Empty=new m({$:0});n=e.ListModel=bE.Class({Append:function(bI){var bJ,bK,bL,bM;bJ=this;bK=this["var"].Get();bL=this.key(bI);bM=o.tryFindIndex(function(bN){return h.Equals(bJ.key(bN),bL);},bK);bM!=null&&bM.$==1?this["var"].Set(this.storage.SSetAt(bM.$0,bI,bK)):this["var"].Set(this.storage.SAppend(bI,bK));this.ObsoleteKey(bL);},ObsoleteKey:function(bI){var bJ,bK;bJ=(bK=null,[this.it.TryGetValue(bI,{get:function(){return bK;},set:function(bL){bK=bL;}}),bK]);bJ[0]?(w.Obsolete(bJ[1]),this.it.Remove(bI)):void 0;},GetEnumerator:function(){return K.Get(this["var"].Get());},GetEnumerator0:function(){return K.Get0(this["var"].Get());}},k,n);n.New=bE.Ctor(function(bI,bJ){n.New$3.call(this,bI,f.Create$1(o.ofSeq(C.distinctBy(bI,bJ.SInit()))),bJ);},n);n.New$3=bE.Ctor(function(bI,bJ,bK){this.key=bI;this["var"]=bJ;this.storage=bK;this.v=I.Map(function(bL){return bL.slice();},this["var"].get_View());this.it=new z.New$5();},n);o.get=function(bI,bJ){o.checkBounds(bI,bJ);return bI[bJ];};o.set=function(bI,bJ,bK){o.checkBounds(bI,bJ);bI[bJ]=bK;};o.length=function(bI){return bI.dims===2?bI.length*bI.length:bI.length;};o.checkBounds=function(bI,bJ){if(bJ<0||bJ>=bI.length)g.FailWith("Index was outside the bounds of the array.");};s=r.TemplateInstance=bE.Class({get_Doc:function(){return this.doc;}},k,s);s.New=bE.Ctor(function(bI,bJ){this.doc=bJ;this.allVars=bI.$==0?bI.$0:g.FailWith("Should not happen");},s);t.CompleteHoles=function(bI,bJ,bK){var bM,bN,bO,bP,bQ,bR;function bL(bS,bT){var bU,bV,bW,bX;return bN.Contains(bS)?null:(bU=bT===0?(bV=f.Create$1(""),[{$:7,$0:bS,$1:bV},bV]):bT===1?(bW=f.Create$1(0),[{$:12,$0:bS,$1:bW},bW]):bT===2?(bX=f.Create$1(false),[{$:8,$0:bS,$1:bX},bX]):g.FailWith("Invalid value type"),(bM.set_Item(bS,bU[1]),{$:1,$0:bU[0]}));}bM=new z.New$5();bN=new A.New$3();bO=K.Get(bJ);try{while(bO.MoveNext()){bP=bO.Current();(bP.$==7?(bQ=[bP.$0,B.Box(bP.$1)],true):bP.$==10?(bQ=[bP.$0,B.Box(bP.$1)],true):bP.$==9?(bQ=[bP.$0,B.Box(bP.$1)],true):bP.$==12?(bQ=[bP.$0,B.Box(bP.$1)],true):bP.$==11?(bQ=[bP.$0,B.Box(bP.$1)],true):bP.$==8&&(bQ=[bP.$0,B.Box(bP.$1)],true))?(bR=bQ[0],bN.Add(bR),bM.set_Item(bR,bQ[1])):void 0;}}finally{if("Dispose"in bO)bO.Dispose();}return[C.append(bJ,o.choose(function(bS){return bL(bS[0],bS[1]);},bK)),{$:0,$0:bM}];};u.listitem=function(bI){F.LoadLocalTemplates("index");return bI?F.NamedTemplate("index",{$:1,$0:"listitem"},bI):void 0;};u.main=function(bI){F.LoadLocalTemplates("index");return bI?F.NamedTemplate("index",{$:1,$0:"main"},bI):void 0;};f=e.Var=bE.Class({},k,f);f.New=bE.Ctor(function(){},f);v=e.ConcreteVar=bE.Class({Get:function(){return this.current;},Set:function(bI){if(this.isConst)(function(bJ){return bJ("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bJ){bF.log(bJ);}));else{w.Obsolete(this.snap);this.current=bI;this.snap=w.New({$:2,$0:bI,$1:[]});}},get_View:function(){return this.view;},UpdateMaybe:function(bI){var bJ;bJ=bI(this.Get());bJ!=null&&bJ.$==1?this.Set(bJ.$0):void 0;}},f,v);v.New=bE.Ctor(function(bI,bJ,bK){var bL;bL=this;f.New.call(this);this.isConst=bI;this.current=bK;this.snap=bJ;this.view=function(){return bL.snap;};this.id=H.Int();},v);w.WhenRun=function(bI,bJ,bK){var bL;bL=bI.s;bL==null?bK():bL!=null&&bL.$==2?(bL.$1.push(bK),bJ(bL.$0)):bL!=null&&bL.$==3?(bL.$0.push(bJ),bL.$1.push(bK)):bJ(bL.$0);};w.Map=function(bI,bJ){var bK,bL;bK=bJ.s;return bK!=null&&bK.$==0?w.New({$:0,$0:bI(bK.$0)}):(bL=w.New({$:3,$0:[],$1:[]}),(w.When(bJ,function(bM){w.MarkDone(bL,bJ,bI(bM));},bL),bL));};w.Map3=function(bI,bJ,bK,bL){var bM,bN,bO,bP;function bQ(bR){var bS,bT,bU,bV;if(!(bS=bP.s,bS!=null&&bS.$==0||bS!=null&&bS.$==2)){bT=w.ValueAndForever(bJ);bU=w.ValueAndForever(bK);bV=w.ValueAndForever(bL);bT!=null&&bT.$==1?bU!=null&&bU.$==1?bV!=null&&bV.$==1?bT.$0[1]&&bU.$0[1]&&bV.$0[1]?w.MarkForever(bP,bI(bT.$0[0],bU.$0[0],bV.$0[0])):w.MarkReady(bP,bI(bT.$0[0],bU.$0[0],bV.$0[0])):void 0:void 0:void 0;}}bM=bJ.s;bN=bK.s;bO=bL.s;return bM!=null&&bM.$==0?bN!=null&&bN.$==0?bO!=null&&bO.$==0?w.New({$:0,$0:bI(bM.$0,bN.$0,bO.$0)}):w.Map3Opt1(bI,bM.$0,bN.$0,bL):bO!=null&&bO.$==0?w.Map3Opt2(bI,bM.$0,bO.$0,bK):w.Map3Opt3(bI,bM.$0,bK,bL):bN!=null&&bN.$==0?bO!=null&&bO.$==0?w.Map3Opt4(bI,bN.$0,bO.$0,bJ):w.Map3Opt5(bI,bN.$0,bJ,bL):bO!=null&&bO.$==0?w.Map3Opt6(bI,bO.$0,bJ,bK):(bP=w.New({$:3,$0:[],$1:[]}),(w.When(bJ,bQ,bP),w.When(bK,bQ,bP),w.When(bL,bQ,bP),bP));};w.Sequence=function(bI){var bJ,bK,bL;function bM(bN){var bO;if(bL[0]===0){bO=o.map(function(bP){var bQ;bQ=bP.s;return bQ!=null&&bQ.$==0?bQ.$0:bQ!=null&&bQ.$==2?bQ.$0:g.FailWith("value not found by View.Sequence");},bJ);o.forall(function(bP){var bQ;bQ=bP.s;return bQ!=null&&bQ.$==0;},bJ)?w.MarkForever(bK,bO):w.MarkReady(bK,bO);}else bL[0]--;}bJ=o.ofSeq(bI);return bJ.length==0?w.New({$:0,$0:[]}):(bK=w.New({$:3,$0:[],$1:[]}),(bL=[o.length(bJ)-1],(o.iter(function(bN){w.When(bN,bM,bK);},bJ),bK)));};w.Map2=function(bI,bJ,bK){var bL,bM,bN;function bO(bP){var bQ,bR,bS;if(!(bQ=bN.s,bQ!=null&&bQ.$==0||bQ!=null&&bQ.$==2)){bR=w.ValueAndForever(bJ);bS=w.ValueAndForever(bK);bR!=null&&bR.$==1?bS!=null&&bS.$==1?bR.$0[1]&&bS.$0[1]?w.MarkForever(bN,bI(bR.$0[0],bS.$0[0])):w.MarkReady(bN,bI(bR.$0[0],bS.$0[0])):void 0:void 0;}}bL=bJ.s;bM=bK.s;return bL!=null&&bL.$==0?bM!=null&&bM.$==0?w.New({$:0,$0:bI(bL.$0,bM.$0)}):w.Map2Opt1(bI,bL.$0,bK):bM!=null&&bM.$==0?w.Map2Opt2(bI,bM.$0,bJ):(bN=w.New({$:3,$0:[],$1:[]}),(w.When(bJ,bO,bN),w.When(bK,bO,bN),bN));};w.Map2Unit=function(bI,bJ){var bK,bL,bM;function bN(){var bO,bP,bQ;if(!(bO=bM.s,bO!=null&&bO.$==0||bO!=null&&bO.$==2)){bP=w.ValueAndForever(bI);bQ=w.ValueAndForever(bJ);bP!=null&&bP.$==1?bQ!=null&&bQ.$==1?bP.$0[1]&&bQ.$0[1]?w.MarkForever(bM,null):w.MarkReady(bM,null):void 0:void 0;}}bK=bI.s;bL=bJ.s;return bK!=null&&bK.$==0?bL!=null&&bL.$==0?w.New({$:0,$0:null}):bJ:bL!=null&&bL.$==0?bI:(bM=w.New({$:3,$0:[],$1:[]}),(w.When(bI,bN,bM),w.When(bJ,bN,bM),bM));};w.WhenObsoleteRun=function(bI,bJ){var bK;bK=bI.s;bK==null?bJ():bK!=null&&bK.$==2?bK.$1.push(bJ):bK!=null&&bK.$==3?bK.$1.push(bJ):void 0;};w.When=function(bI,bJ,bK){var bL;bL=bI.s;bL==null?w.Obsolete(bK):bL!=null&&bL.$==2?(w.EnqueueSafe(bL.$1,bK),bJ(bL.$0)):bL!=null&&bL.$==3?(bL.$0.push(bJ),w.EnqueueSafe(bL.$1,bK)):bJ(bL.$0);};w.MarkDone=function(bI,bJ,bK){var bL;if(bL=bJ.s,bL!=null&&bL.$==0)w.MarkForever(bI,bK);else w.MarkReady(bI,bK);};w.Map3Opt1=function(bI,bJ,bK,bL){return w.Map(function(bM){return bI(bJ,bK,bM);},bL);};w.Map3Opt2=function(bI,bJ,bK,bL){return w.Map(function(bM){return bI(bJ,bM,bK);},bL);};w.Map3Opt3=function(bI,bJ,bK,bL){return w.Map2(function(bM,bN){return bI(bJ,bM,bN);},bK,bL);};w.Map3Opt4=function(bI,bJ,bK,bL){return w.Map(function(bM){return bI(bM,bJ,bK);},bL);};w.Map3Opt5=function(bI,bJ,bK,bL){return w.Map2(function(bM,bN){return bI(bM,bJ,bN);},bK,bL);};w.Map3Opt6=function(bI,bJ,bK,bL){return w.Map2(function(bM,bN){return bI(bM,bN,bJ);},bK,bL);};w.ValueAndForever=function(bI){var bJ;bJ=bI.s;return bJ!=null&&bJ.$==0?{$:1,$0:[bJ.$0,true]}:bJ!=null&&bJ.$==2?{$:1,$0:[bJ.$0,false]}:null;};w.MarkForever=function(bI,bJ){var bK,bL,bM,bN;bK=bI.s;if(bK!=null&&bK.$==3){bI.s={$:0,$0:bJ};bL=bK.$0;for(bM=0,bN=o.length(bL)-1;bM<=bN;bM++)(o.get(bL,bM))(bJ);}else void 0;};w.MarkReady=function(bI,bJ){var bK,bL,bM,bN;bK=bI.s;if(bK!=null&&bK.$==3){bI.s={$:2,$0:bJ,$1:bK.$1};bL=bK.$0;for(bM=0,bN=o.length(bL)-1;bM<=bN;bM++)(o.get(bL,bM))(bJ);}else void 0;};w.Map2Opt1=function(bI,bJ,bK){return w.Map(function(bL){return bI(bJ,bL);},bK);};w.Map2Opt2=function(bI,bJ,bK){return w.Map(function(bL){return bI(bL,bJ);},bK);};w.Copy=function(bI){var bJ,bK,bL;bJ=bI.s;return bJ==null?bI:bJ!=null&&bJ.$==2?(bK=w.New({$:2,$0:bJ.$0,$1:[]}),(w.WhenObsolete(bI,bK),bK)):bJ!=null&&bJ.$==3?(bL=w.New({$:3,$0:[],$1:[]}),(w.When(bI,function(bM){w.MarkDone(bL,bI,bM);},bL),bL)):bI;};w.EnqueueSafe=function(bI,bJ){var bK,bL,bM,bN;bI.push(bJ);if(bI.length%20===0){bK=bI.slice(0);bz.Clear(bI);for(bL=0,bM=o.length(bK)-1;bL<=bM;bL++){bN=o.get(bK,bL);typeof bN=="object"?function(bO){if(bO.s)bI.push(bO);}(bN):function(bO){bI.push(bO);}(bN);}}else void 0;};w.Join=function(bI){var bJ;bJ=w.New({$:3,$0:[],$1:[]});w.When(bI,function(bK){var bL;bL=bK();w.When(bL,function(bM){var bN,bO;if((bN=bL.s,bN!=null&&bN.$==0)&&(bO=bI.s,bO!=null&&bO.$==0))w.MarkForever(bJ,bM);else w.MarkReady(bJ,bM);},bJ);},bJ);return bJ;};w.WhenObsolete=function(bI,bJ){var bK;bK=bI.s;bK==null?w.Obsolete(bJ):bK!=null&&bK.$==2?w.EnqueueSafe(bK.$1,bJ):bK!=null&&bK.$==3?w.EnqueueSafe(bK.$1,bJ):void 0;};x.$cctor=function(){x.$cctor=a.ignore;x.People=n.FromSeq(["John","Paul"]);};z=y.Dictionary=bE.Class({set_Item:function(bI,bJ){this.set(bI,bJ);},set:function(bI,bJ){var bK,bL,bM,bN;bK=this;bL=this.hash(bI);bM=this.data[bL];bM?(bN=o.tryFindIndex(function(bO){return bK.equals.apply(null,[(g.KeyValue(bO))[0],bI]);},bM),bN==null?(this.count=this.count+1,bM.push({K:bI,V:bJ})):bM[bN.$0]={K:bI,V:bJ}):(this.count=this.count+1,this.data[bL]=new a.Array({K:bI,V:bJ}));},TryGetValue:function(bI,bJ){var bK,bL,bM;bK=this;bL=this.data[this.hash(bI)];return bL&&(bM=o.tryPick(function(bN){var bO;bO=g.KeyValue(bN);return bK.equals.apply(null,[bO[0],bI])?{$:1,$0:bO[1]}:null;},bL),bM!=null&&bM.$==1&&(bJ.set(bM.$0),true));},Remove:function(bI){return this.remove(bI);},ContainsKey:function(bI){var bJ,bK;bJ=this;bK=this.data[this.hash(bI)];return bK&&o.exists(function(bL){return bJ.equals.apply(null,[(g.KeyValue(bL))[0],bI]);},bK);},remove:function(bI){var bJ,bK,bL,bM;bJ=this;bK=this.hash(bI);bL=this.data[bK];return bL&&(bM=o.filter(function(bN){return!bJ.equals.apply(null,[(g.KeyValue(bN))[0],bI]);},bL),o.length(bM)<bL.length&&(this.count=this.count-1,this.data[bK]=bM,true));},get_Item:function(bI){return this.get(bI);},get:function(bI){var bJ,bK;bJ=this;bK=this.data[this.hash(bI)];return bK?o.pick(function(bL){var bM;bM=g.KeyValue(bL);return bJ.equals.apply(null,[bM[0],bI])?{$:1,$0:bM[1]}:null;},bK):J.notPresent();},GetEnumerator:function(){return K.Get0(this);},GetEnumerator0:function(){return K.Get0(o.concat(R.GetFieldValues(this.data)));}},k,z);z.New$5=bE.Ctor(function(){z.New$6.call(this,[],h.Equals,h.Hash);},z);z.New$6=bE.Ctor(function(bI,bJ,bK){var bL,bM;this.equals=bJ;this.hash=bK;this.count=0;this.data=[];bL=K.Get(bI);try{while(bL.MoveNext()){bM=bL.Current();this.set(bM.K,bM.V);}}finally{if("Dispose"in bL)bL.Dispose();}},z);A=y.HashSet=bE.Class({Add:function(bI){return this.add(bI);},Contains:function(bI){var bJ;bJ=this.data[this.hash(bI)];return bJ==null?false:this.arrContains(bI,bJ);},add:function(bI){var bJ,bK;bJ=this.hash(bI);bK=this.data[bJ];return bK==null?(this.data[bJ]=[bI],this.count=this.count+1,true):this.arrContains(bI,bK)?false:(bK.push(bI),this.count=this.count+1,true);},arrContains:function(bI,bJ){var bK,bL,bM,bN;bK=true;bL=0;bN=bJ.length;while(bK&&bL<bN)if(this.equals.apply(null,[bJ[bL],bI]))bK=false;else bL=bL+1;return!bK;},IntersectWith:function(bI){var bJ,bK,bL,bM,bN;bJ=new A.New$4(bI,this.equals,this.hash);bK=bb.concat(this.data);for(bL=0,bM=bK.length-1;bL<=bM;bL++){bN=bK[bL];!bJ.Contains(bN)?this.Remove(bN):void 0;}},get_Count:function(){return this.count;},CopyTo:function(bI){var bJ,bK,bL,bM;bJ=0;bK=bb.concat(this.data);for(bL=0,bM=bK.length-1;bL<=bM;bL++)o.set(bI,bL,bK[bL]);},ExceptWith:function(bI){var bJ;bJ=K.Get(bI);try{while(bJ.MoveNext())this.Remove(bJ.Current());}finally{if("Dispose"in bJ)bJ.Dispose();}},Remove:function(bI){var bJ;bJ=this.data[this.hash(bI)];return bJ==null?false:this.arrRemove(bI,bJ)&&(this.count=this.count-1,true);},arrRemove:function(bI,bJ){var bK,bL,bM,bN;bK=true;bL=0;bN=bJ.length;while(bK&&bL<bN)if(this.equals.apply(null,[bJ[bL],bI])){bJ.splice.apply(bJ,[bL,1]);bK=false;}else bL=bL+1;return!bK;},GetEnumerator:function(){return K.Get(bb.concat(this.data));},GetEnumerator0:function(){return K.Get(bb.concat(this.data));}},k,A);A.New$3=bE.Ctor(function(){A.New$4.call(this,[],h.Equals,h.Hash);},A);A.New$4=bE.Ctor(function(bI,bJ,bK){var bL;this.equals=bJ;this.hash=bK;this.data=[];this.count=0;bL=K.Get(bI);try{while(bL.MoveNext())this.add(bL.Current());}finally{if("Dispose"in bL)bL.Dispose();}},A);A.New$2=bE.Ctor(function(bI){A.New$4.call(this,bI,h.Equals,h.Hash);},A);B.Box=a.id;o.choose=function(bI,bJ){var bK,bL,bM,bN;bK=[];for(bL=0,bM=bJ.length-1;bL<=bM;bL++){bN=bI(bJ[bL]);bN==null?void 0:bK.push(bN.$0);}return bK;};o.tryFindIndex=function(bI,bJ){var bK,bL;bK=null;bL=0;while(bL<bJ.length&&bK==null){bI(bJ[bL])?bK={$:1,$0:bL}:void 0;bL=bL+1;}return bK;};o.tryPick=function(bI,bJ){var bK,bL,bM;bK=null;bL=0;while(bL<bJ.length&&bK==null){bM=bI(bJ[bL]);bM!=null&&bM.$==1?bK=bM:void 0;bL=bL+1;}return bK;};o.foldBack=function(bI,bJ,bK){var bL,bM,bN,bO,bP;bL=bK;bN=bJ.length;for(bO=1,bP=bN;bO<=bP;bO++)bL=bI(bJ[bN-bO],bL);return bL;};o.iter=function(bI,bJ){var bK,bL;for(bK=0,bL=bJ.length-1;bK<=bL;bK++)bI(bJ[bK]);};o.concat=function(bI){return a.Array.prototype.concat.apply([],o.ofSeq(bI));};o.ofSeq=function(bI){var bJ,bK;if(bI instanceof a.Array)return bI.slice();else if(bI instanceof m)return o.ofList(bI);else{bJ=[];bK=K.Get(bI);try{while(bK.MoveNext())bJ.push(bK.Current());return bJ;}finally{if("Dispose"in bK)bK.Dispose();}}};o.exists=function(bI,bJ){var bK,bL,bM,bN;bK=false;bL=0;bN=o.length(bJ);while(!bK&&bL<bN)if(bI(bJ[bL]))bK=true;else bL=bL+1;return bK;};o.map=function(bI,bJ){var bK,bL,bM;bK=new a.Array(bJ.length);for(bL=0,bM=bJ.length-1;bL<=bM;bL++)bK[bL]=bI(bJ[bL]);return bK;};o.filter=function(bI,bJ){var bK,bL,bM;bK=[];for(bL=0,bM=bJ.length-1;bL<=bM;bL++)if(bI(bJ[bL]))bK.push(bJ[bL]);return bK;};o.ofList=function(bI){var bJ,bK;bK=[];bJ=bI;while(!(bJ.$==0)){bK.push(l.head(bJ));bJ=l.tail(bJ);}return bK;};o.forall=function(bI,bJ){var bK,bL,bM,bN;bK=true;bL=0;bN=o.length(bJ);while(bK&&bL<bN)if(bI(bJ[bL]))bL=bL+1;else bK=false;return bK;};o.pick=function(bI,bJ){var bK;bK=o.tryPick(bI,bJ);return bK==null?g.FailWith("KeyNotFoundException"):bK.$0;};o.create=function(bI,bJ){var bK,bL,bM;bK=new a.Array(bI);for(bL=0,bM=bI-1;bL<=bM;bL++)bK[bL]=bJ;return bK;};o.init=function(bI,bJ){var bK,bL,bM;bI<0?g.FailWith("Negative size given."):null;bK=new a.Array(bI);for(bL=0,bM=bI-1;bL<=bM;bL++)bK[bL]=bJ(bL);return bK;};C.append=function(bI,bJ){return{GetEnumerator:function(){var bK,bL;bK=K.Get(bI);bL=[true];return new M.New(bK,null,function(bM){var bN;return bM.s.MoveNext()?(bM.c=bM.s.Current(),true):(bN=bM.s,!h.Equals(bN,null)?bN.Dispose():void 0,bM.s=null,bL[0]&&(bL[0]=false,bM.s=K.Get(bJ),bM.s.MoveNext()?(bM.c=bM.s.Current(),true):(bM.s.Dispose(),bM.s=null,false)));},function(bM){var bN;bN=bM.s;!h.Equals(bN,null)?bN.Dispose():void 0;});}};};C.fold=function(bI,bJ,bK){var bL,bM;bL=bJ;bM=K.Get(bK);try{while(bM.MoveNext())bL=bI(bL,bM.Current());return bL;}finally{if("Dispose"in bM)bM.Dispose();}};C.iter=function(bI,bJ){var bK;bK=K.Get(bJ);try{while(bK.MoveNext())bI(bK.Current());}finally{if("Dispose"in bK)bK.Dispose();}};C.map=function(bI,bJ){return{GetEnumerator:function(){var bK;bK=K.Get(bJ);return new M.New(null,null,function(bL){return bK.MoveNext()&&(bL.c=bI(bK.Current()),true);},function(){bK.Dispose();});}};};C.distinctBy=function(bI,bJ){return{GetEnumerator:function(){var bK,bL;bK=K.Get(bJ);bL=new A.New$3();return new M.New(null,null,function(bM){var bN,bO;if(bK.MoveNext()){bN=bK.Current();bO=bL.Add(bI(bN));while(!bO&&bK.MoveNext()){bN=bK.Current();bO=bL.Add(bI(bN));}return bO&&(bM.c=bN,true);}else return false;},function(){bK.Dispose();});}};};C.forall=function(bI,bJ){return!C.exists(function(bK){return!bI(bK);},bJ);};C.max=function(bI){var bJ,bK,bL;bJ=K.Get(bI);try{if(!bJ.MoveNext())C.seqEmpty();bK=bJ.Current();while(bJ.MoveNext()){bL=bJ.Current();h.Compare(bL,bK)===1?bK=bL:void 0;}return bK;}finally{if("Dispose"in bJ)bJ.Dispose();}};C.exists=function(bI,bJ){var bK,bL;bK=K.Get(bJ);try{bL=false;while(!bL&&bK.MoveNext())bL=bI(bK.Current());return bL;}finally{if("Dispose"in bK)bK.Dispose();}};C.seqEmpty=function(){return g.FailWith("The input sequence was empty.");};E.NewFromSeq=function(bI){var bJ,bK,bL;bJ={};bK=K.Get(bI);try{while(bK.MoveNext()){bL=bK.Current();bJ[bL[0]]=bL[1];}}finally{if("Dispose"in bK)bK.Dispose();}return bJ;};F=e.Doc=bE.Class({},k,F);F.RunById=function(bI,bJ){var bK;bK=P.Doc().getElementById(bI);h.Equals(bK,null)?g.FailWith("invalid id: "+bI):F.Run(bK,bJ);};F.Convert=function(bI,bJ){return F.Flatten(I.MapSeqCached(bI,bJ));};F.LoadLocalTemplates=function(bI){var bJ;bJ=S.LoadedTemplateFile("");bJ.count>0?S.LoadedTemplates().set_Item(bI,bJ):(function(){var bK,bL,bM,bN;while(true){bK=a.document.querySelector("[ws-template]");if(h.Equals(bK,null)){bL=a.document.querySelector("[ws-children-template]");if(h.Equals(bL,null))return null;else{bM=bL.getAttribute("ws-children-template");bL.removeAttribute("ws-children-template");F.PrepareTemplate(bI,{$:1,$0:bM},function(bO){return function(){return P.ChildrenArray(bO);};}(bL));}}else{bN=bK.getAttribute("ws-template");F.PrepareSingleTemplate(bI,{$:1,$0:bN},bK);}}}(),S.LoadedTemplates().set_Item("",S.LoadedTemplateFile(bI)));};F.NamedTemplate=function(bI,bJ,bK){var bL,bM;bL=(bM=null,[S.LoadedTemplateFile(bI).TryGetValue(bJ==null?"":bJ.$0,{get:function(){return bM;},set:function(bN){bM=bN;}}),bM]);return bL[0]?F.ChildrenTemplate(bL[1].cloneNode(true),bK):(bF.warn("Local template doesn't exist",bJ),F.Empty());};F.Run=function(bI,bJ){var bK;F.LoadLocalTemplates$1();bK=bJ.docNode;S.LinkElement(bI,bK);I.Sink(U.StartProcessor(S.PerformAnimatedUpdate(S.CreateRunState(bI,bK),bK)),bJ.updates);};F.Flatten=function(bI){return F.EmbedView(I.Map(F.Concat,bI));};F.PrepareTemplate=function(bI,bJ,bK){var bL,bM,bN,bO,bP;if(!S.LoadedTemplateFile(bI).ContainsKey(bJ==null?"":bJ.$0)){bL=bK();for(bM=0,bN=bL.length-1;bM<=bN;bM++){bO=o.get(bL,bM);bP=bO.parentNode;h.Equals(bP,null)?void 0:bP.removeChild(bO);}F.PrepareTemplateStrict(bI,bJ,bL);}};F.PrepareSingleTemplate=function(bI,bJ,bK){var bL,bM,bN;bK.removeAttribute("ws-template");bL=bK.getAttribute("ws-replace");bL===null?void 0:(bK.removeAttribute("ws-replace"),bM=bK.parentNode,h.Equals(bM,null)?void 0:(bN=a.document.createElement(bK.tagName),bN.setAttribute("ws-replace",bL),bM.replaceChild(bN,bK)));F.PrepareTemplateStrict(bI,bJ,[bK]);};F.ChildrenTemplate=function(bI,bJ){var bK,bL,bM,bN,bO,bR,bS,bT,bU,bV,bW,bX;function bP(bY,bZ){var b0,b1,b2;b0=_0.Insert(bY,bZ);bS.push(_0.Updates(b0));bT.push([bY,b0]);b1=bE.GetOptional(b0.OnAfterRender);return b1==null?null:(b2=b1.$0,void bU.push(function(){b2(bY);}));}function bQ(bY){var bZ,b0;bZ=(b0=null,[bV.TryGetValue(bY,{get:function(){return b0;},set:function(b1){b0=b1;}}),b0]);return bZ[0]?bZ[1].$==0?{$:1,$0:bZ[1].$1}:bZ[1].$==1?{$:1,$0:F.TextNode(bZ[1].$1)}:bZ[1].$==2?{$:1,$0:F.TextView(bZ[1].$1)}:bZ[1].$==7?{$:1,$0:F.TextView(bZ[1].$1.get_View())}:bZ[1].$==8?{$:1,$0:F.TextView(I.Map(a.String,bZ[1].$1.get_View()))}:bZ[1].$==9?{$:1,$0:F.TextView(I.Map(function(b1){return b1.get_Input();},bZ[1].$1.get_View()))}:bZ[1].$==10?{$:1,$0:F.TextView(I.Map(a.String,bZ[1].$1.get_View()))}:bZ[1].$==11?{$:1,$0:F.TextView(I.Map(function(b1){return b1.get_Input();},bZ[1].$1.get_View()))}:bZ[1].$==12?{$:1,$0:F.TextView(I.Map(a.String,bZ[1].$1.get_View()))}:(bF.warn("Content hole filled with attribute data",bY),null):null;}bR=[];bS=[];bT=[];bU=[];bV=new z.New$5();bW=K.Get(bJ);try{while(bW.MoveNext()){bX=bW.Current();bV.set_Item(bX.$0,bX);}}finally{if("Dispose"in bW)bW.Dispose();}bK=P.ChildrenArray(bI);P.IterSelector(bI,"[ws-hole]",function(bY){var bZ,b0,b1;b1=bY.getAttribute("ws-hole");bY.removeAttribute("ws-hole");while(bY.hasChildNodes())bY.removeChild(bY.lastChild);bZ=bQ(b1);bZ!=null&&bZ.$==1?(b0=bZ.$0,S.LinkElement(bY,b0.docNode),bR.push(X.New(_0.Empty(bY),b0.docNode,null,bY,H.Int(),null)),bS.push(b0.updates)):void 0;});P.IterSelector(bI,"[ws-replace]",function(bY){var bZ,b0,b1,b2,b3,b4;bZ=bQ(bY.getAttribute("ws-replace"));bZ!=null&&bZ.$==1?(b0=bZ.$0,b1=bY.parentNode,b2=a.document.createTextNode(""),b1.replaceChild(b2,bY),b3=S.InsertBeforeDelim(b2,b0.docNode),b4=o.tryFindIndex(function(b5){return bY===b5;},bK),b4==null?void 0:o.set(bK,b4.$0,b0.docNode),bR.push(X.New(_0.Empty(b1),b0.docNode,{$:1,$0:[b3,b2]},b1,H.Int(),null)),bS.push(b0.updates)):void 0;});P.IterSelector(bI,"[ws-attr]",function(bY){var bZ,b0,b1;bZ=bY.getAttribute("ws-attr");bY.removeAttribute("ws-attr");b0=(b1=null,[bV.TryGetValue(bZ,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);b0[0]?b0[1].$==3?bP(bY,b0[1].$1):bF.warn("Attribute hole filled with non-attribute data",bZ):void 0;});P.IterSelector(bI,"[ws-on]",function(bY){bP(bY,_3.Concat(o.choose(function(bZ){var b0,b1,b2;b0=_5.SplitChars(bZ,[":"],1);b1=(b2=null,[bV.TryGetValue(o.get(b0,1),{get:function(){return b2;},set:function(b3){b2=b3;}}),b2]);return b1[0]?b1[1].$==4?{$:1,$0:_2.Handler(o.get(b0,0),b1[1].$1)}:b1[1].$==5?{$:1,$0:_3.Handler(o.get(b0,0),b1[1].$2)}:(bF.warn("Event hole on"+o.get(b0,0)+" filled with non-event data",o.get(b0,1)),null):null;},_5.SplitChars(bY.getAttribute("ws-on"),[" "],1))));bY.removeAttribute("ws-on");});P.IterSelector(bI,"[ws-onafterrender]",function(bY){var bZ,b0,b1;bZ=bY.getAttribute("ws-onafterrender");b0=(b1=null,[bV.TryGetValue(bZ,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);b0[0]?b0[1].$==6?(bY.removeAttribute("ws-onafterrender"),bP(bY,_2.OnAfterRender(b0[1].$1))):bF.warn("onafterrender hole filled with non-onafterrender data",bZ):void 0;});P.IterSelector(bI,"[ws-var]",function(bY){var bZ,b0,b1;bZ=bY.getAttribute("ws-var");bY.removeAttribute("ws-var");b0=(b1=null,[bV.TryGetValue(bZ,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);b0[0]?b0[1].$==7?bP(bY,_2.Value(b0[1].$1)):b0[1].$==8?bP(bY,_2.Checked(b0[1].$1)):b0[1].$==9?bP(bY,_2.IntValue(b0[1].$1)):b0[1].$==10?bP(bY,_2.IntValueUnchecked(b0[1].$1)):b0[1].$==11?bP(bY,_2.FloatValue(b0[1].$1)):b0[1].$==12?bP(bY,_2.FloatValueUnchecked(b0[1].$1)):bF.warn("Var hole filled with non-Var data",bZ):void 0;});P.IterSelector(bI,"[ws-attr-holes]",function(bY){var bZ,b0,b1,b2;bZ=new a.RegExp(S.TextHoleRE(),"g");b0=_5.SplitChars(bY.getAttribute("ws-attr-holes"),[" "],1);bY.removeAttribute("ws-attr-holes");for(b1=0,b2=b0.length-1;b1<=b2;b1++)(function(){var b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;ca=o.get(b0,b1);cb=bY.getAttribute(ca);b3=null;b4=0;cc=[];while(b3=bZ.exec(cb),b3!==null){cd=_4.string(cb,{$:1,$0:b4},{$:1,$0:bZ.lastIndex-o.get(b3,0).length-1});b4=bZ.lastIndex;cc.push([cd,o.get(b3,1)]);}b6=_4.string(cb,{$:1,$0:b4},null);bZ.lastIndex=0;b7=o.foldBack(function(ce,cf){return(function(cg){var ch,ci;ch=cg[0];ci=cg[1];return function(cj){var ck,cl,cm,cn,co;ck=cj[0];cl=cj[1];cm=(cn=(co=null,[bV.TryGetValue(ci,{get:function(){return co;},set:function(cp){co=cp;}}),co]),cn[0]?cn[1].$==1?{$:0,$0:cn[1].$1}:cn[1].$==2?{$:1,$0:cn[1].$1}:cn[1].$==7?{$:1,$0:cn[1].$1.get_View()}:cn[1].$==8?{$:1,$0:I.Map(a.String,cn[1].$1.get_View())}:cn[1].$==9?{$:1,$0:I.Map(function(cp){return cp.get_Input();},cn[1].$1.get_View())}:cn[1].$==10?{$:1,$0:I.Map(a.String,cn[1].$1.get_View())}:cn[1].$==11?{$:1,$0:I.Map(function(cp){return cp.get_Input();},cn[1].$1.get_View())}:cn[1].$==12?{$:1,$0:I.Map(a.String,cn[1].$1.get_View())}:(bF.warn("Attribute value hole filled with non-text data",ci),{$:0,$0:""}):{$:0,$0:""});return cm.$==1?[ch,new m({$:1,$0:ck===""?cm.$0:I.Map(function(cp){return cp+ck;},cm.$0),$1:cl})]:[ch+cm.$0+ck,cl];};}(ce))(cf);},cc,[b6,m.Empty]);return bP(bY,b7[1].$==1?b7[1].$1.$==1?b7[1].$1.$1.$==1?b7[1].$1.$1.$1.$==0?(b8=b7[0],_2.Dynamic(ca,I.Map3(function(ce,cf,cg){return b8+ce+cf+cg;},b7[1].$0,b7[1].$1.$0,b7[1].$1.$1.$0))):(b9=b7[0],_2.Dynamic(ca,I.Map(function(ce){return b9+_5.concat("",ce);},I.Sequence(b7[1])))):(b_=b7[0],_2.Dynamic(ca,I.Map2(function(ce,cf){return b_+ce+cf;},b7[1].$0,b7[1].$1.$0))):b7[0]===""?_2.Dynamic(ca,b7[1].$0):(b$=b7[0],_2.Dynamic(ca,I.Map(function(ce){return b$+ce;},b7[1].$0))):_3.Create(ca,b7[0]));}());});bL=bE.DeleteEmptyFields({Els:bK,Dirty:true,Holes:bR,Attrs:bT,Render:(bM=bU.length==0?null:{$:1,$0:function(bY){o.iter(function(bZ){bZ(bY);},bU);}},bM?bM.$0:void 0)},["Render"]);bN=_6.TreeReduce(I.Const(),I.Map2Unit,bS);return!h.Equals(bK,null)&&bK.length===1&&(o.get(bK,0)instanceof O&&(h.Equals(o.get(bK,0).nodeType,O.ELEMENT_NODE)&&(bO=o.get(bK,0),true)))?_7.TreeNode(bL,bN):F.Mk({$:6,$0:bL},bN);};F.Empty=function(){return F.Mk(null,I.Const());};F.LoadLocalTemplates$1=function(){if(!S.LocalTemplatesLoaded()){S.set_LocalTemplatesLoaded(true);F.LoadLocalTemplates("");}};F.Concat=function(bI){var bJ;bJ=_6.ofSeqNonCopying(bI);return _6.TreeReduce(F.Empty(),F.Append,bJ);};F.EmbedView=function(bI){var bJ;bJ=S.CreateEmbedNode();return F.Mk({$:2,$0:bJ},I.Map(a.ignore,I.Bind(function(bK){S.UpdateEmbedNode(bJ,bK.docNode);return bK.updates;},bI)));};F.PrepareTemplateStrict=function(bI,bJ,bK){var bL,bM;function bN(bZ){var b1,b2,b3,b4,b5,b6,b7,b8;function b0(b9){var b_;b_=bZ.getAttribute(b9);b_===null?void 0:bZ.setAttribute(b9,b_.toLowerCase());}b1=bZ.attributes;b2=[];b3=[];b4=[];for(b5=0,b6=b1.length-1;b5<=b6;b5++){b7=b1.item(b5);_5.StartsWith(b7.nodeName,"ws-on")&&b7.nodeName!=="ws-onafterrender"&&b7.nodeName!=="ws-on"?(b2.push(b7.nodeName),b3.push(_4.string(b7.nodeName,{$:1,$0:"ws-on".length},null)+":"+b7.nodeValue.toLowerCase())):!_5.StartsWith(b7.nodeName,"ws-")&&(new a.RegExp(S.TextHoleRE())).test(b7.nodeValue)?(b7.nodeValue=(b8=new a.RegExp(S.TextHoleRE(),"g"),b7.nodeValue.replace(b8,function(b9,b_){return"${"+b_.toLowerCase()+"}";})),b4.push(b7.nodeName)):void 0;}!(b3.length==0)?bZ.setAttribute("ws-on",_5.concat(" ",b3)):void 0;!(b4.length==0)?bZ.setAttribute("ws-attr-holes",_5.concat(" ",b4)):void 0;b0("ws-hole");b0("ws-replace");b0("ws-attr");b0("ws-onafterrender");b0("ws-var");o.iter(function(b9){bZ.removeAttribute(b9);},b2);}function bO(bZ){var b0,b1,b2,b3,b4,b5;b0=null;b1=0;b3=bZ.textContent;b4=new a.RegExp(S.TextHoleRE(),"g");while(b0=b4.exec(b3),b0!==null){bZ.parentNode.insertBefore(a.document.createTextNode(_4.string(b3,{$:1,$0:b1},{$:1,$0:b4.lastIndex-o.get(b0,0).length-1})),bZ);b1=b4.lastIndex;b5=a.document.createElement("span");b5.setAttribute("ws-replace",o.get(b0,1).toLowerCase());bZ.parentNode.insertBefore(b5,bZ);}b4.lastIndex=0;bZ.textContent=_4.string(b3,{$:1,$0:b1},null);}function bP(bZ,b0){function b1(b2){P.IterSelector(bZ,"["+b2+"]",function(b3){var b4,b5;b4=(b5=null,[b0.TryGetValue(b3.getAttribute(b2).toLowerCase(),{get:function(){return b5;},set:function(b6){b5=b6;}}),b5]);b4[0]?b3.setAttribute(b2,b4[1]):void 0;});}b1("ws-hole");b1("ws-replace");b1("ws-attr");b1("ws-onafterrender");b1("ws-var");P.IterSelector(bZ,"[ws-on]",function(b2){b2.setAttribute("ws-on",_5.concat(" ",o.map(function(b3){var b4,b5,b6;b4=_5.SplitChars(b3,[":"],1);b5=(b6=null,[b0.TryGetValue(o.get(b4,1),{get:function(){return b6;},set:function(b7){b6=b7;}}),b6]);return b5[0]?o.get(b4,0)+":"+b5[1]:b3;},_5.SplitChars(b2.getAttribute("ws-on"),[" "],1))));});return P.IterSelector(bZ,"[ws-attr-holes]",function(b2){var b3,b4,b5;b3=_5.SplitChars(b2.getAttribute("ws-attr-holes"),[" "],1);for(b4=0,b5=b3.length-1;b4<=b5;b4++)(function(){var b6;function b7(b8,b9){var b_;b_=g.KeyValue(b9);return b8.replace(new a.RegExp("\\${"+b_[0]+"}","ig"),"${"+b_[1]+"}");}b6=o.get(b3,b4);return b2.setAttribute(b6,(((bE.Curried3(C.fold))(b7))(b2.getAttribute(b6)))(b0));}());});}function bQ(bZ,b0){var b1,b2,b3,b4,b5;bN(b0);b1=b0.nodeName.toLowerCase();b2=bZ.querySelector("[ws-attr="+b1+"]");if(h.Equals(b2,null))return bF.warn("Filling non-existent attr hole",b1);else{b2.removeAttribute("ws-attr");for(b3=0,b4=b0.attributes.length-1;b3<=b4;b3++){b5=b0.attributes.item(b3);b5.name==="class"&&b2.hasAttribute("class")?b2.setAttribute("class",b2.getAttribute("class")+" "+b5.nodeValue):b2.setAttribute(b5.name,b5.nodeValue);}return;}}function bR(bZ,b0){function b1(b2){P.IterSelector(bZ,"["+b2+"]",function(b3){if(!b0.Contains(b3.getAttribute(b2)))b3.removeAttribute(b2);});}b1("ws-attr");b1("ws-onafterrender");b1("ws-var");P.IterSelector(bZ,"[ws-hole]",function(b2){if(!b0.Contains(b2.getAttribute("ws-hole"))){b2.removeAttribute("ws-hole");while(b2.hasChildNodes())b2.removeChild(b2.lastChild);}});P.IterSelector(bZ,"[ws-replace]",function(b2){if(!b0.Contains(b2.getAttribute("ws-replace")))b2.parentNode.removeChild(b2);});P.IterSelector(bZ,"[ws-on]",function(b2){b2.setAttribute("ws-on",_5.concat(" ",o.filter(function(b3){return b0.Contains(o.get(_5.SplitChars(b3,[":"],1),1));},_5.SplitChars(b2.getAttribute("ws-on"),[" "],1))));});return P.IterSelector(bZ,"[ws-attr-holes]",function(b2){var b3,b4,b5,b6,b7;b3=_5.SplitChars(b2.getAttribute("ws-attr-holes"),[" "],1);for(b4=0,b5=b3.length-1;b4<=b5;b4++){b6=o.get(b3,b4);b2.setAttribute(b6,(b7=new a.RegExp(S.TextHoleRE(),"g"),b2.getAttribute(b6).replace(b7,function(b8,b9){return b0.Contains(b9)?b8:"";})));}});}function bS(bZ,b0){var b1;b1=bZ.querySelector("[ws-replace]");return h.Equals(b1,null)?(bF.warn("Filling non-existent text hole",bJ),null):(b1.parentNode.replaceChild(new a.Text(b0),b1),{$:1,$0:b1.getAttribute("ws-replace")});}function bT(bZ,b0,b1){while(true)if(bZ.hasChildNodes())b1=b0.insertBefore(bZ.lastChild,b1);else return null;}function bU(bZ,b0,b1){var b2,b3,b4,b5,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq;function b6(cr){}while(true)switch(bZ){case 0:b7=_4.string(b0.nodeName,{$:1,$0:3},null).toLowerCase();b8=(b2=b7.indexOf("."),b2===-1?[bI,b7]:[_4.string(b7,null,{$:1,$0:b2-1}),_4.string(b7,{$:1,$0:b2+1},null)]);b9=b8[1];b_=b8[0];if(!S.LoadedTemplates().ContainsKey(b_))return bF.warn("Instantiating non-loaded template",b9);else{b$=S.LoadedTemplates().get_Item(b_);if(!b$.ContainsKey(b9))return bF.warn("Instantiating non-loaded template",b9);else{ca=b$.get_Item(b9);cb=ca.cloneNode(true);cc=new A.New$3();cd=new z.New$5();ce=b0.attributes;for(cf=0,cg=ce.length-1;cf<=cg;cf++){ch=ce.item(cf).name.toLowerCase();cd.set_Item(ch,(ci=ce.item(cf).nodeValue,ci===""?ch:ci.toLowerCase()));!cc.Add(ch)?bF.warn("Hole mapped twice",ch):void 0;}for(cj=0,ck=b0.childNodes.length-1;cj<=ck;cj++){cl=b0.childNodes[cj];h.Equals(cl.nodeType,O.ELEMENT_NODE)?!cc.Add(cl.nodeName.toLowerCase())?bF.warn("Hole filled twice",b9):void 0:void 0;}cm=b0.childNodes.length===1&&h.Equals(b0.firstChild.nodeType,O.TEXT_NODE);if(cm){b4=bS(cb,b0.firstChild.textContent);((function(cr){return function(cs){if(cs!=null)cr(cs.$0);};}((b5=function(cr){return function(cs){return cr.Add(cs);};}(cc),function(cr){return b6(b5(cr));})))(b4));}bR(cb,cc);if(!cm){for(cn=0,co=b0.childNodes.length-1;cn<=co;cn++){cp=b0.childNodes[cn];h.Equals(cp.nodeType,O.ELEMENT_NODE)?cp.hasAttributes()?bQ(cb,cp):bV(cb,cp):void 0;}}bP(cb,cd);(((function(cr){function cs(ct,cu){return bT(cr,ct,cu);}return function(ct){return function(cu){return cs(ct,cu);};};}(cb))(b0.parentNode))(b0));b0.parentNode.removeChild(b0);return;}}break;case 1:if(b1!==null){cq=b1.nextSibling;if(h.Equals(b1.nodeType,O.TEXT_NODE))bO(b1);else if(h.Equals(b1.nodeType,O.ELEMENT_NODE))bX(b1);b1=cq;}else return null;break;}}function bV(bZ,b0){var b1,b3,b4;function b2(b5,b6){var b7,b8,b9;if(b3==="title"&&b0.hasChildNodes()){b7=bG.parseHTML(b0.textContent);b0.removeChild(b0.firstChild);for(b8=0,b9=b7.length-1;b8<=b9;b8++)b0.appendChild(o.get(b7,b8));}else null;bX(b0);return bT(b0,b5,b6);}b3=b0.nodeName.toLowerCase();P.IterSelector(bZ,"[ws-attr-holes]",function(b5){var b6,b7,b8,b9,b_;b6=_5.SplitChars(b5.getAttribute("ws-attr-holes"),[" "],1);for(b7=0,b8=b6.length-1;b7<=b8;b7++){b9=o.get(b6,b7);b5.setAttribute(b9,(b_=new a.RegExp("\\${"+b3+"}","ig"),b5.getAttribute(b9).replace(b_,b0.textContent)));}});b4=bZ.querySelector("[ws-hole="+b3+"]");if(h.Equals(b4,null)){b1=bZ.querySelector("[ws-replace="+b3+"]");return h.Equals(b1,null)?null:(b2(b1.parentNode,b1),void b1.parentNode.removeChild(b1));}else{while(b4.hasChildNodes())b4.removeChild(b4.lastChild);b4.removeAttribute("ws-hole");return b2(b4,null);}}function bW(bZ){return bU(0,bZ);}function bX(bZ){var b0,b1;if(_5.StartsWith(bZ.nodeName.toLowerCase(),"ws-")&&!bZ.hasAttribute("ws-template"))bW(bZ);else{bN(bZ);b0=bZ.getAttribute("ws-template");if(b0===null){b1=bZ.getAttribute("ws-children-template");if(b1===null)bY(bZ,bZ.firstChild);else{bZ.removeAttribute("ws-children-template");F.PrepareTemplate(bI,{$:1,$0:b1},function(){return P.ChildrenArray(bZ);});while(bZ.hasChildNodes())bZ.removeChild(bZ.lastChild);}}else F.PrepareSingleTemplate(bI,{$:1,$0:b0},bZ);}}function bY(bZ,b0){return bU(1,bZ,b0);}bL=F.FakeRoot(bK);bM=(bJ==null?"":bJ.$0).toLowerCase();S.LoadedTemplateFile(bI).set_Item(bM,bL);o.length(bK)>0?bY(bL,o.get(bK,0)):void 0;};F.TextNode=function(bI){return F.Mk({$:5,$0:P.CreateText(bI)},I.Const());};F.TextView=function(bI){var bJ;bJ=S.CreateTextNode();return F.Mk({$:4,$0:bJ},I.Map(function(bK){S.UpdateTextNode(bJ,bK);},bI));};F.Mk=function(bI,bJ){return new F.New(bI,bJ);};F.Append=function(bI,bJ){return F.Mk({$:0,$0:bI.docNode,$1:bJ.docNode},I.Map2Unit(bI.updates,bJ.updates));};F.FakeRoot=function(bI){var bJ,bK,bL;bJ=a.document.createElement("div");for(bK=0,bL=bI.length-1;bK<=bL;bK++)bJ.appendChild(o.get(bI,bK));return bJ;};F.New=bE.Ctor(function(bI,bJ){this.docNode=bI;this.updates=bJ;},F);H.Int=function(){H.set_counter(H.counter()+1);return H.counter();};H.set_counter=function(bI){V.$cctor();V.counter=bI;};H.counter=function(){V.$cctor();return V.counter;};I=e.View=bE.Class({},null,I);w.Obsolete=function(bI){var bJ,bK,bL,bM,bN;bK=bI.s;if(bK==null||(bK!=null&&bK.$==2?(bJ=bK.$1,false):bK!=null&&bK.$==3?(bJ=bK.$1,false):true))void 0;else{bI.s=null;for(bL=0,bM=o.length(bJ)-1;bL<=bM;bL++){bN=o.get(bJ,bL);typeof bN=="object"?function(bO){w.Obsolete(bO);}(bN):bN();}}};w.New=function(bI){return{s:bI};};n.FromSeq=function(bI){return n.Create(a.id,bI);};n.Create=function(bI,bJ){return n.CreateWithStorage(bI,W.InMemory(o.ofSeq(bJ)));};n.CreateWithStorage=function(bI,bJ){return new n.New(bI,bJ);};J.notPresent=function(){return g.FailWith("The given key was not present in the dictionary.");};K.Get=function(bI){return bI instanceof a.Array?K.ArrayEnumerator(bI):h.Equals(typeof bI,"string")?K.StringEnumerator(bI):bI.GetEnumerator();};K.ArrayEnumerator=function(bI){return new M.New(0,null,function(bJ){var bK;bK=bJ.s;return bK<o.length(bI)&&(bJ.c=o.get(bI,bK),bJ.s=bK+1,true);},void 0);};K.StringEnumerator=function(bI){return new M.New(0,null,function(bJ){var bK;bK=bJ.s;return bK<bI.length&&(bJ.c=bI[bK],bJ.s=bK+1,true);},void 0);};K.Get0=function(bI){return bI instanceof a.Array?K.ArrayEnumerator(bI):h.Equals(typeof bI,"string")?K.StringEnumerator(bI):"GetEnumerator0"in bI?bI.GetEnumerator0():bI.GetEnumerator();};M=K.T=bE.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},k,M);M.New=bE.Ctor(function(bI,bJ,bK,bL){this.s=bI;this.c=bJ;this.n=bK;this.d=bL;},M);P.Doc=function(){T.$cctor();return T.Doc;};P.ChildrenArray=function(bI){var bJ,bK,bL;bJ=[];for(bK=0,bL=bI.childNodes.length-1;bK<=bL;bK++)bJ.push(bI.childNodes[bK]);return bJ;};P.IterSelector=function(bI,bJ,bK){var bL,bM,bN;bL=bI.querySelectorAll(bJ);for(bM=0,bN=bL.length-1;bM<=bN;bM++)bK(bL[bM]);};P.CreateText=function(bI){return P.Doc().createTextNode(bI);};P.SetAttr=function(bI,bJ,bK){bI.setAttribute(bJ,bK);};P.InsertAt=function(bI,bJ,bK){var bL;if(!(bK.parentNode===bI&&bJ===(bL=bK.nextSibling,h.Equals(bL,null)?null:bL)))bI.insertBefore(bK,bJ);};P.RemoveNode=function(bI,bJ){if(bJ.parentNode===bI)bI.removeChild(bJ);};Q.TryParseInt32=function(bI,bJ){return Q.TryParse(bI,-2147483648,2147483647,bJ);};I.MapSeqCached=function(bI,bJ){return I.MapSeqCachedBy(a.id,bI,bJ);};I.Sink=function(bI,bJ){function bK(){w.WhenRun(bJ(),bI,function(){bh.scheduler().Fork(bK);});}bh.scheduler().Fork(bK);};I.MapSeqCachedBy=function(bI,bJ,bK){var bL;bL=[new z.New$5()];return I.Map(function(bM){var bN,bO,bP;bN=bL[0];bO=new z.New$5();bP=_6.mapInPlace(function(bQ){var bR,bS;bR=bI(bQ);bS=bN.ContainsKey(bR)?bN.get_Item(bR):bJ(bQ);bO.set_Item(bR,bS);return bS;},o.ofSeq(bM));bL[0]=bO;return bP;},bK);};I.Map=function(bI,bJ){return I.CreateLazy(function(){return w.Map(bI,bJ());});};I.Map3=function(bI,bJ,bK,bL){return I.CreateLazy(function(){return w.Map3(bI,bJ(),bK(),bL());});};I.Sequence=function(bI){return I.CreateLazy(function(){return w.Sequence(C.map(function(bJ){return bJ();},bI));});};I.Map2=function(bI,bJ,bK){return I.CreateLazy(function(){return w.Map2(bI,bJ(),bK());});};I.Const=function(bI){var bJ;bJ=w.New({$:0,$0:bI});return function(){return bJ;};};I.Map2Unit=function(bI,bJ){return I.CreateLazy(function(){return w.Map2Unit(bI(),bJ());});};I.CreateLazy=function(bI){var bJ;bJ={c:null,o:bI};return function(){var bK,bL;bK=bJ.c;return bK===null?(bK=bJ.o(),bJ.c=bK,(bL=bK.s,bL!=null&&bL.$==0)?bJ.o=null:w.WhenObsoleteRun(bK,function(){bJ.c=null;}),bK):bK;};};I.Bind=function(bI,bJ){return I.Join(I.Map(bI,bJ));};I.Join=function(bI){return I.CreateLazy(function(){return w.Join(bI());});};R.GetFieldValues=function(bI){var bJ,bK;bJ=[];for(var bL in bI)bJ.push(bI[bL]);return bJ;};S.LoadedTemplateFile=function(bI){var bJ,bK,bL;bJ=(bK=null,[S.LoadedTemplates().TryGetValue(bI,{get:function(){return bK;},set:function(bM){bK=bM;}}),bK]);return bJ[0]?bJ[1]:(bL=new z.New$5(),(S.LoadedTemplates().set_Item(bI,bL),bL));};S.LoadedTemplates=function(){Z.$cctor();return Z.LoadedTemplates;};S.LinkElement=function(bI,bJ){S.InsertDoc(bI,bJ,null);};S.CreateRunState=function(bI,bJ){return _.New($.get_Empty(),S.CreateElemNode(bI,_0.EmptyAttr(),bJ));};S.PerformAnimatedUpdate=function(bI,bJ){var bK;return ba.get_UseAnimations()?(bK=null,bh.Delay(function(){var bL,bM,bN;bL=$.FindAll(bJ);bM=S.ComputeChangeAnim(bI,bL);bN=S.ComputeEnterAnim(bI,bL);return bh.Bind(ba.Play(ba.Append(bM,S.ComputeExitAnim(bI,bL))),function(){return bh.Bind(S.SyncElemNodesNextFrame(bI),function(){return bh.Bind(ba.Play(bN),function(){bI.PreviousNodes=bL;return bh.Return(null);});});});})):S.SyncElemNodesNextFrame(bI);};S.InsertBeforeDelim=function(bI,bJ){var bK,bL;bK=bI.parentNode;bL=a.document.createTextNode("");bK.insertBefore(bL,bI);S.LinkPrevElement(bI,bJ);return bL;};S.TextHoleRE=function(){Z.$cctor();return Z.TextHoleRE;};S.LocalTemplatesLoaded=function(){Z.$cctor();return Z.LocalTemplatesLoaded;};S.set_LocalTemplatesLoaded=function(bI){Z.$cctor();Z.LocalTemplatesLoaded=bI;};S.InsertDoc=function(bI,bJ,bK){var bL;return bJ!=null&&bJ.$==1?S.InsertNode(bI,bJ.$0.El,bK):bJ!=null&&bJ.$==2?(bL=bJ.$0,(bL.Dirty=false,S.InsertDoc(bI,bL.Current,bK))):bJ==null?bK:bJ!=null&&bJ.$==4?S.InsertNode(bI,bJ.$0.Text,bK):bJ!=null&&bJ.$==5?S.InsertNode(bI,bJ.$0,bK):bJ!=null&&bJ.$==6?o.foldBack(function(bM,bN){return bM.constructor===L?S.InsertDoc(bI,bM,bN):S.InsertNode(bI,bM,bN);},bJ.$0.Els,bK):S.InsertDoc(bI,bJ.$0,S.InsertDoc(bI,bJ.$1,bK));};S.CreateElemNode=function(bI,bJ,bK){var bL;S.LinkElement(bI,bK);bL=_0.Insert(bI,bJ);return X.New(bL,bK,null,bI,H.Int(),bE.GetOptional(bL.OnAfterRender));};S.ComputeChangeAnim=function(bI,bJ){var bK;function bL(bM){return _0.HasChangeAnim(bM.Attr);}bK=function(bM){return $.Filter(bL,bM);};return ba.Concat(o.map(function(bM){return _0.GetChangeAnim(bM.Attr);},$.ToArray($.Intersect(bK(bI.PreviousNodes),bK(bJ)))));};S.ComputeEnterAnim=function(bI,bJ){return ba.Concat(o.map(function(bK){return _0.GetEnterAnim(bK.Attr);},$.ToArray($.Except(bI.PreviousNodes,$.Filter(function(bK){return _0.HasEnterAnim(bK.Attr);},bJ)))));};S.ComputeExitAnim=function(bI,bJ){return ba.Concat(o.map(function(bK){return _0.GetExitAnim(bK.Attr);},$.ToArray($.Except(bJ,$.Filter(function(bK){return _0.HasExitAnim(bK.Attr);},bI.PreviousNodes)))));};S.SyncElemNodesNextFrame=function(bI){function bJ(bK){a.requestAnimationFrame(function(){S.SyncElemNode(bI.Top);bK();});}return bh.FromContinuations(function(bK,bL,bM){return bJ.apply(null,[bK,bL,bM]);});};S.CreateEmbedNode=function(){return{Current:null,Dirty:false};};S.UpdateEmbedNode=function(bI,bJ){bI.Current=bJ;bI.Dirty=true;};S.CreateTextNode=function(){return{Text:P.CreateText(""),Dirty:false,Value:""};};S.UpdateTextNode=function(bI,bJ){bI.Value=bJ;bI.Dirty=true;};S.LinkPrevElement=function(bI,bJ){S.InsertDoc(bI.parentNode,bJ,bI);};S.InsertNode=function(bI,bJ,bK){P.InsertAt(bI,bK,bJ);return bJ;};S.SyncElemNode=function(bI){S.SyncElement(bI);S.Sync(bI.Children);S.AfterRender(bI);};S.SyncElement=function(bI){function bJ(bK){function bL(bM){var bN,bO;return bM!=null&&bM.$==0?bL(bM.$0)||bL(bM.$1):bM!=null&&bM.$==2?(bN=bM.$0,bN.Dirty||bL(bN.Current)):bM!=null&&bM.$==6&&(bO=bM.$0,bO.Dirty||o.exists(bJ,bO.Holes));}return bL(bK.Children);}_0.Sync(bI.El,bI.Attr);bJ(bI)?S.DoSyncElement(bI):void 0;};S.Sync=function(bI){var bJ,bK;if(bI!=null&&bI.$==1)S.SyncElemNode(bI.$0);else if(bI!=null&&bI.$==2)S.Sync(bI.$0.Current);else if(bI==null);else if(bI!=null&&bI.$==5);else if(bI!=null&&bI.$==4){bJ=bI.$0;bJ.Dirty?(bJ.Text.nodeValue=bJ.Value,bJ.Dirty=false):void 0;}else if(bI!=null&&bI.$==6){bK=bI.$0;o.iter(function(bL){S.SyncElemNode(bL);},bK.Holes);o.iter(function(bL){_0.Sync(bL[0],bL[1]);},bK.Attrs);S.AfterRender(bK);}else{S.Sync(bI.$0);S.Sync(bI.$1);}};S.AfterRender=function(bI){var bJ;bJ=bE.GetOptional(bI.Render);bJ!=null&&bJ.$==1?(bJ.$0(bI.El),bE.SetOptional(bI,"Render",null)):void 0;};S.DoSyncElement=function(bI){var bJ,bK,bL;function bM(bN,bO){var bP,bQ;return bN!=null&&bN.$==1?bN.$0.El:bN!=null&&bN.$==2?(bP=bN.$0,bP.Dirty?(bP.Dirty=false,S.InsertDoc(bJ,bP.Current,bO)):bM(bP.Current,bO)):bN==null?bO:bN!=null&&bN.$==4?bN.$0.Text:bN!=null&&bN.$==5?bN.$0:bN!=null&&bN.$==6?(bQ=bN.$0,(bQ.Dirty?bQ.Dirty=false:void 0,o.foldBack(function(bR,bS){return bR.constructor===L?bM(bR,bS):bR;},bQ.Els,bO))):bM(bN.$0,bM(bN.$1,bO));}bJ=bI.El;by.Iter((bK=bI.El,function(bN){P.RemoveNode(bK,bN);}),by.Except(by.DocChildren(bI),by.Children(bI.El,bE.GetOptional(bI.Delimiters))));bM(bI.Children,(bL=bE.GetOptional(bI.Delimiters),bL!=null&&bL.$==1?bL.$0[1]:null));};T.$cctor=function(){T.$cctor=a.ignore;T.Doc=a.document;};U.StartProcessor=function(bI){var bJ;function bK(){var bL;bL=null;return bh.Delay(function(){return bh.Bind(bI,function(){var bM;bM=bJ[0];return bM===1?(bJ[0]=0,bh.Zero()):bM===2?(bJ[0]=1,bK()):bh.Zero();});});}bJ=[0];return function(){var bL;bL=bJ[0];bL===0?(bJ[0]=1,bh.Start(bK(),null)):bL===1?bJ[0]=2:void 0;};};V.$cctor=function(){V.$cctor=a.ignore;V.counter=0;};W.InMemory=function(bI){return new bc.New(bI);};X=e.DocElemNode=bE.Class({Equals:function(bI){return this.ElKey===bI.ElKey;},GetHashCode:function(){return this.ElKey;}},null,X);X.New=function(bI,bJ,bK,bL,bM,bN){var bO;return new X((bO={Attr:bI,Children:bJ,El:bL,ElKey:bM},(bE.SetOptional(bO,"Delimiters",bK),bE.SetOptional(bO,"Render",bN),bO)));};Z.$cctor=function(){Z.$cctor=a.ignore;Z.LoadedTemplates=new z.New$5();Z.LocalTemplatesLoaded=false;Z.TextHoleRE="\\${([^}]+)}";};_0.Insert=function(bI,bJ){var bK,bL,bM;function bN(bO){if(!(bO===null))if(bO!=null&&bO.$==1)bK.push(bO.$0);else if(bO!=null&&bO.$==2){bN(bO.$0);bN(bO.$1);}else if(bO!=null&&bO.$==3)bO.$0(bI);else if(bO!=null&&bO.$==4)bL.push(bO.$0);}bK=[];bL=[];bN(bJ);bM=bK.slice(0);return be.New(bI,_0.Flags(bJ),bM,bL.length===0?null:{$:1,$0:function(bO){C.iter(function(bP){bP(bO);},bL);}});};_0.Updates=function(bI){return _6.MapTreeReduce(function(bJ){return bJ.NChanged();},I.Const(),I.Map2Unit,bI.DynNodes);};_0.Empty=function(bI){return be.New(bI,0,[],null);};_0.Flags=function(bI){return bI!==null&&bI.hasOwnProperty("flags")?bI.flags:0;};_0.Static=function(bI){return new _3({$:3,$0:bI});};_0.Dynamic=function(bI,bJ){return new _3({$:1,$0:new bl.New(bI,bJ)});};_0.EmptyAttr=function(){bm.$cctor();return bm.EmptyAttr;};_0.HasChangeAnim=function(bI){var bJ;bJ=4;return(bI.DynFlags&bJ)===bJ;};_0.GetChangeAnim=function(bI){return _0.GetAnim(bI,function(bJ,bK){return bJ.NGetChangeAnim(bK);});};_0.HasEnterAnim=function(bI){var bJ;bJ=1;return(bI.DynFlags&bJ)===bJ;};_0.GetEnterAnim=function(bI){return _0.GetAnim(bI,function(bJ,bK){return bJ.NGetEnterAnim(bK);});};_0.HasExitAnim=function(bI){var bJ;bJ=2;return(bI.DynFlags&bJ)===bJ;};_0.GetExitAnim=function(bI){return _0.GetAnim(bI,function(bJ,bK){return bJ.NGetExitAnim(bK);});};_0.AppendTree=function(bI,bJ){var bK;return bI===null?bJ:bJ===null?bI:(bK=new _3({$:2,$0:bI,$1:bJ}),(_0.SetFlags(bK,_0.Flags(bI)|_0.Flags(bJ)),bK));};_0.GetAnim=function(bI,bJ){return ba.Concat(o.map(function(bK){return bJ(bK,bI.DynElem);},bI.DynNodes));};_0.SetFlags=function(bI,bJ){bI.flags=bJ;};_0.Sync=function(bI,bJ){o.iter(function(bK){bK.NSync(bI);},bJ.DynNodes);};_1=e.CheckedInput=bE.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,_1);_2.Handler=function(bI,bJ){return _0.Static(function(bK){bK.addEventListener(bI,function(bL){return(bJ(bK))(bL);},false);});};_2.OnAfterRender=function(bI){return new _3({$:4,$0:bI});};_2.Value=function(bI){function bJ(bK){return{$:1,$0:bK};}return _2.CustomValue(bI,a.id,function(bK){return bJ(a.id(bK));});};_2.Checked=function(bI){function bJ(bK,bL){return!h.Equals(bI.Get(),bK.checked)?bI.Set(bK.checked):null;}return _3.Concat([_2.DynamicProp("checked",bI.get_View()),_2.Handler("change",function(bK){return function(bL){return bJ(bK,bL);};}),_2.Handler("click",function(bK){return function(bL){return bJ(bK,bL);};})]);};_2.IntValue=function(bI){return _2.CustomVar(bI,function(bJ,bK){var bL;bL=bK.get_Input();return bJ.value!==bL?void(bJ.value=bL):null;},function(bJ){var bK,bL,bM;bK=bJ.value;return{$:1,$0:bf.isBlank(bK)?(bJ.checkValidity?bJ.checkValidity():true)?new _1({$:2,$0:bK}):new _1({$:1,$0:bK}):(bL=(bM=0,[Q.TryParseInt32(bK,{get:function(){return bM;},set:function(bN){bM=bN;}}),bM]),bL[0]?new _1({$:0,$0:bL[1],$1:bK}):new _1({$:1,$0:bK}))};});};_2.IntValueUnchecked=function(bI){return _2.CustomValue(bI,a.String,function(bJ){var bK;return bf.isBlank(bJ)?{$:1,$0:0}:(bK=+bJ,bK!==bK>>0?null:{$:1,$0:bK});});};_2.FloatValue=function(bI){return _2.CustomVar(bI,function(bJ,bK){var bL;bL=bK.get_Input();return bJ.value!==bL?void(bJ.value=bL):null;},function(bJ){var bK,bL;bK=bJ.value;return{$:1,$0:bf.isBlank(bK)?(bJ.checkValidity?bJ.checkValidity():true)?new _1({$:2,$0:bK}):new _1({$:1,$0:bK}):(bL=+bK,a.isNaN(bL)?new _1({$:1,$0:bK}):new _1({$:0,$0:bL,$1:bK}))};});};_2.FloatValueUnchecked=function(bI){return _2.CustomValue(bI,a.String,function(bJ){var bK;return bf.isBlank(bJ)?{$:1,$0:0}:(bK=+bJ,a.isNaN(bK)?null:{$:1,$0:bK});});};_2.Dynamic=function(bI,bJ){return _0.Dynamic(bJ,function(bK){return function(bL){return P.SetAttr(bK,bI,bL);};});};_2.CustomValue=function(bI,bJ,bK){return _2.CustomVar(bI,function(bL,bM){bL.value=bJ(bM);},function(bL){return bK(bL.value);});};_2.DynamicProp=function(bI,bJ){return _0.Dynamic(bJ,function(bK){return function(bL){bK[bI]=bL;};});};_2.CustomVar=function(bI,bJ,bK){function bL(bN,bO){return bI.UpdateMaybe(function(bP){var bQ,bR;bQ=bK(bN);return bQ!=null&&bQ.$==1&&(!h.Equals(bQ.$0,bP)&&(bR=[bQ,bQ.$0],true))?bR[0]:null;});}function bM(bN,bO){var bP,bQ;bP=bK(bN);return bP!=null&&bP.$==1&&(h.Equals(bP.$0,bO)&&(bQ=bP.$0,true))?null:bJ(bN,bO);}return _3.Concat([_2.Handler("change",function(bN){return function(bO){return bL(bN,bO);};}),_2.Handler("input",function(bN){return function(bO){return bL(bN,bO);};}),_2.Handler("keypress",function(bN){return function(bO){return bL(bN,bO);};}),_2.DynamicCustom(function(bN){return function(bO){return bM(bN,bO);};},bI.get_View())]);};_2.DynamicCustom=function(bI,bJ){return _0.Dynamic(bJ,bI);};_3=e.AttrProxy=bE.Class({},null,_3);_3.Handler=function(bI,bJ){return _3.HandlerImpl(bI,bJ);};_3.Concat=function(bI){var bJ;bJ=_6.ofSeqNonCopying(bI);return _6.TreeReduce(_0.EmptyAttr(),_3.Append,bJ);};_3.Create=function(bI,bJ){return _0.Static(function(bK){P.SetAttr(bK,bI,bJ);});};_3.HandlerImpl=function(bI,bJ){return _0.Static(function(bK){bK.addEventListener(bI,function(bL){return(bJ(bK))(bL);},false);});};_3.Append=function(bI,bJ){return _0.AppendTree(bI,bJ);};_4.string=function(bI,bJ,bK){return bJ==null?bK!=null&&bK.$==1?bI.slice(0,bK.$0+1):"":bK==null?bI.slice(bJ.$0):bI.slice(bJ.$0,bK.$0+1);};_5.concat=function(bI,bJ){return o.ofSeq(bJ).join(bI);};_5.SplitChars=function(bI,bJ,bK){return _5.Split(bI,new a.RegExp("["+_5.RegexEscape(bJ.join(""))+"]"),bK);};_5.StartsWith=function(bI,bJ){return bI.substring(0,bJ.length)==bJ;};_5.RegexEscape=function(bI){return bI.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};_5.Split=function(bI,bJ,bK){return bK===1?o.filter(function(bL){return bL!=="";},_5.SplitWith(bI,bJ)):_5.SplitWith(bI,bJ);};_5.forall=function(bI,bJ){return C.forall(bI,_5.protect(bJ));};_5.SplitWith=function(bI,bJ){return bI.split(bJ);};_5.protect=function(bI){return bI===null?"":bI;};_6.TreeReduce=function(bI,bJ,bK){var bL;function bM(bN,bO){var bP,bQ;return bO<=0?bI:bO===1&&(bN>=0&&bN<bL)?o.get(bK,bN):(bQ=bO/2>>0,bJ(bM(bN,bQ),bM(bN+bQ,bO-bQ)));}bL=o.length(bK);return bM(0,bL);};_6.mapInPlace=function(bI,bJ){var bK,bL;for(bK=0,bL=bJ.length-1;bK<=bL;bK++)bJ[bK]=bI(bJ[bK]);return bJ;};_6.ofSeqNonCopying=function(bI){var bJ,bK;if(bI instanceof a.Array)return bI;else if(bI instanceof m)return o.ofList(bI);else if(bI===null)return[];else{bJ=[];bK=K.Get(bI);try{while(bK.MoveNext())bJ.push(bK.Current());return bJ;}finally{if("Dispose"in bK)bK.Dispose();}}};_6.MapTreeReduce=function(bI,bJ,bK,bL){var bM;function bN(bO,bP){var bQ,bR;return bP<=0?bJ:bP===1&&(bO>=0&&bO<bM)?bI(o.get(bL,bO)):(bR=bP/2>>0,bK(bN(bO,bR),bN(bO+bR,bP-bR)));}bM=o.length(bL);return bN(0,bM);};_7=e.Elt=bE.Class({},F,_7);_7.TreeNode=function(bI,bJ){var bK,bL;function bM(bN){return bN[1];}bK=bg.Create(bJ);return new _7.New$1({$:6,$0:bI},I.Map2Unit((bL=o.map(function(bN){return _0.Updates(bM(bN));},bI.Attrs),_6.TreeReduce(I.Const(),I.Map2Unit,bL)),bK.v),o.get(bI.Els,0),bK);};_7.New$1=bE.Ctor(function(bI,bJ,bK,bL){F.New.call(this,bI,bJ);this.docNode$1=bI;this.updates$1=bJ;this.elt=bK;this.rvUpdates=bL;},_7);_.New=function(bI,bJ){return{PreviousNodes:bI,Top:bJ};};$.get_Empty=function(){return{$:0,$0:new A.New$3()};};$.FindAll=function(bI){var bJ;function bK(bM){if(bM!=null&&bM.$==0){bK(bM.$0);bK(bM.$1);}else if(bM!=null&&bM.$==1)bL(bM.$0);else if(bM!=null&&bM.$==2)bK(bM.$0.Current);else if(bM!=null&&bM.$==6)o.iter(bL,bM.$0.Holes);}function bL(bM){bJ.push(bM);bK(bM.Children);}bJ=[];bK(bI);return{$:0,$0:new A.New$2(bJ)};};$.Filter=function(bI,bJ){return{$:0,$0:br.Filter(bI,bJ.$0)};};$.Intersect=function(bI,bJ){return{$:0,$0:br.Intersect(bI.$0,bJ.$0)};};$.ToArray=function(bI){return br.ToArray(bI.$0);};$.Except=function(bI,bJ){return{$:0,$0:br.Except(bI.$0,bJ.$0)};};ba.get_UseAnimations=function(){return bi.UseAnimations();};ba.Play=function(bI){var bJ;bJ=null;return bh.Delay(function(){return bh.Bind(ba.Run(a.ignore,bi.Actions(bI)),function(){bi.Finalize(bI);return bh.Return(null);});});};ba.Append=function(bI,bJ){return{$:0,$0:bj.Append(bI.$0,bJ.$0)};};ba.Concat=function(bI){return{$:0,$0:bj.Concat(C.map(bi.List,bI))};};ba.Run=function(bI,bJ){var bK;function bL(bM){function bN(bO,bP){var bQ;bQ=bP-bO;bJ.Compute(bQ);bI();return bQ<=bK?void a.requestAnimationFrame(function(bR){bN(bO,bR);}):bM();}a.requestAnimationFrame(function(bO){bN(bO,bO);});}bK=bJ.Duration;return bK===0?bh.Zero():bh.FromContinuations(function(bM,bN,bO){return bL.apply(null,[bM,bN,bO]);});};ba.get_Empty=function(){return{$:0,$0:bj.Empty()};};bb.concat=function(bI){var bJ,bK;bJ=[];for(var bL in bI)bJ.push.apply(bJ,bI[bL]);return bJ;};bc=W.ArrayStorage=bE.Class({SSetAt:function(bI,bJ,bK){o.set(bK,bI,bJ);return bK;},SAppend:function(bI,bJ){bJ.push(bI);return bJ;},SInit:function(){return this.init;}},k,bc);bc.New=bE.Ctor(function(bI){this.init=bI;},bc);be.New=function(bI,bJ,bK,bL){var bM;bM={DynElem:bI,DynFlags:bJ,DynNodes:bK};bE.SetOptional(bM,"OnAfterRender",bL);return bM;};bf.isBlank=function(bI){return _5.forall(bk.IsWhiteSpace,bI);};bg=e.Updates=bE.Class({},null,bg);bg.Create=function(bI){var bJ;bJ=null;bJ=bg.New(bI,null,function(){var bK;bK=bJ.s;return bK===null?(bK=w.Copy(bJ.c()),bJ.s=bK,w.WhenObsoleteRun(bK,function(){bJ.s=null;}),bK):bK;});return bJ;};bg.New=function(bI,bJ,bK){return new bg({c:bI,s:bJ,v:bK});};bh.Delay=function(bI){return function(bJ){try{(bI(null))(bJ);}catch(bK){bJ.k({$:1,$0:bK});}};};bh.Bind=function(bI,bJ){return bh.checkCancel(function(bK){bI(bn.New(function(bL){var bM;if(bL.$==0){bM=bL.$0;bh.scheduler().Fork(function(){try{(bJ(bM))(bK);}catch(bN){bK.k({$:1,$0:bN});}});}else bh.scheduler().Fork(function(){bK.k(bL);});},bK.ct));});};bh.Zero=function(){bo.$cctor();return bo.Zero;};bh.Start=function(bI,bJ){var bK,bL;bK=(bL=(bh.defCTS())[0],bJ==null?bL:bJ.$0);bh.scheduler().Fork(function(){if(!bK.c)bI(bn.New(function(bM){if(bM.$==1)bh.UncaughtAsyncError(bM.$0);},bK));});};bh.Return=function(bI){return function(bJ){bJ.k({$:0,$0:bI});};};bh.checkCancel=function(bI){return function(bJ){if(bJ.ct.c)bh.cancel(bJ);else bI(bJ);};};bh.defCTS=function(){bo.$cctor();return bo.defCTS;};bh.UncaughtAsyncError=function(bI){bF.log("WebSharper: Uncaught asynchronous exception",bI);};bh.FromContinuations=function(bI){return function(bJ){var bK;function bL(bM){if(bK[0])g.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bK[0]=true;bh.scheduler().Fork(bM);}}bK=[false];bI(function(bM){bL(function(){bJ.k({$:0,$0:bM});});},function(bM){bL(function(){bJ.k({$:1,$0:bM});});},function(bM){bL(function(){bJ.k({$:2,$0:bM});});});};};bh.cancel=function(bI){bI.k({$:2,$0:new bv.New(bI.ct)});};bh.scheduler=function(){bo.$cctor();return bo.scheduler;};bi.UseAnimations=function(){bq.$cctor();return bq.UseAnimations;};bi.Actions=function(bI){return bi.ConcatActions(o.choose(function(bJ){return bJ.$==1?{$:1,$0:bJ.$0}:null;},bj.ToArray(bI.$0)));};bi.Finalize=function(bI){o.iter(function(bJ){if(bJ.$==0)bJ.$0();},bj.ToArray(bI.$0));};bi.List=function(bI){return bI.$0;};bi.ConcatActions=function(bI){var bJ,bK,bL,bM;bJ=_6.ofSeqNonCopying(bI);bK=o.length(bJ);return bK===0?bi.Const():bK===1?o.get(bJ,0):(bL=C.max(C.map(function(bN){return bN.Duration;},bJ)),(bM=o.map(function(bN){return bi.Prolong(bL,bN);},bJ),bi.Def(bL,function(bN){o.iter(function(bO){bO.Compute(bN);},bM);})));};bi.Const=function(bI){return bi.Def(0,function(){return bI;});};bi.Prolong=function(bI,bJ){var bK,bL,bM;bK=bJ.Compute;bL=bJ.Duration;bM=bx.Create(function(){return bJ.Compute(bJ.Duration);});return{Compute:function(bN){return bN>=bL?bM.f():bK(bN);},Duration:bI};};bi.Def=function(bI,bJ){return{Compute:bJ,Duration:bI};};bj.Append=function(bI,bJ){return bI.$==0?bJ:bJ.$==0?bI:{$:2,$0:bI,$1:bJ};};bj.Concat=function(bI){var bJ;bJ=_6.ofSeqNonCopying(bI);return _6.TreeReduce(bj.Empty(),bj.Append,bJ);};bj.ToArray=function(bI){var bJ;function bK(bL){if(bL.$==1)bJ.push(bL.$0);else if(bL.$==2){bK(bL.$0);bK(bL.$1);}else if(bL.$==3)o.iter(function(bM){bJ.push(bM);},bL.$0);}bJ=[];bK(bI);return bJ.slice(0);};bj.Empty=function(){bw.$cctor();return bw.Empty;};bk.IsWhiteSpace=function(bI){return bI.match(new a.RegExp("\\s"))!==null;};Q.TryParse=function(bI,bJ,bK,bL){var bM,bN;bM=+bI;bN=bM===bM-bM%1&&bM>=bJ&&bM<=bK;bN?bL.set(bM):void 0;return bN;};bl=e.DynamicAttrNode=bE.Class({NChanged:function(){return this.updates;},NGetChangeAnim:function(bI){return ba.get_Empty();},NGetEnterAnim:function(bI){return ba.get_Empty();},NGetExitAnim:function(bI){return ba.get_Empty();},NSync:function(bI){if(this.dirty){(this.push(bI))(this.value);this.dirty=false;}}},k,bl);bl.New=bE.Ctor(function(bI,bJ){var bK;bK=this;this.push=bJ;this.value=void 0;this.dirty=false;this.updates=I.Map(function(bL){bK.value=bL;bK.dirty=true;},bI);},bl);bm.$cctor=function(){bm.$cctor=a.ignore;bm.EmptyAttr=null;};bn.New=function(bI,bJ){return{k:bI,ct:bJ};};bo.$cctor=function(){bo.$cctor=a.ignore;bo.noneCT=bp.New(false,[]);bo.scheduler=new bs.New();bo.defCTS=[new bt.New()];bo.Zero=bh.Return();bo.GetCT=function(bI){bI.k({$:0,$0:bI.ct});};};bp.New=function(bI,bJ){return{c:bI,r:bJ};};bq.$cctor=function(){bq.$cctor=a.ignore;bq.CubicInOut=bu.Custom(function(bI){var bJ;bJ=bI*bI;return 3*bJ-2*(bJ*bI);});bq.UseAnimations=true;};br.Filter=function(bI,bJ){return new A.New$2(o.filter(bI,br.ToArray(bJ)));};br.Intersect=function(bI,bJ){var bK;bK=new A.New$2(br.ToArray(bI));bK.IntersectWith(br.ToArray(bJ));return bK;};br.ToArray=function(bI){var bJ;bJ=o.create(bI.get_Count(),void 0);bI.CopyTo(bJ);return bJ;};br.Except=function(bI,bJ){var bK;bK=new A.New$2(br.ToArray(bJ));bK.ExceptWith(br.ToArray(bI));return bK;};l.head=function(bI){return bI.$==1?bI.$0:l.listEmpty();};l.tail=function(bI){return bI.$==1?bI.$1:l.listEmpty();};l.listEmpty=function(){return g.FailWith("The input list was empty.");};bs=bh.Scheduler=bE.Class({Fork:function(bI){var bJ;bJ=this;this.robin.push(bI);this.idle?(this.idle=false,a.setTimeout(function(){bJ.tick();},0)):void 0;},tick:function(){var bI,bJ,bK;bJ=this;bK=bH.now();bI=true;while(bI)if(this.robin.length===0){this.idle=true;bI=false;}else{(this.robin.shift())();bH.now()-bK>40?(a.setTimeout(function(){bJ.tick();},0),bI=false):void 0;}}},k,bs);bs.New=bE.Ctor(function(){this.idle=true;this.robin=[];},bs);bt=d.CancellationTokenSource=bE.Class({},k,bt);bt.New=bE.Ctor(function(){this.c=false;this.pending=null;this.r=[];this.init=1;},bt);bu=e.Easing=bE.Class({},k,bu);bu.Custom=function(bI){return new bu.New(bI);};bu.New=bE.Ctor(function(bI){this.transformTime=bI;},bu);bv=d.OperationCanceledException=bE.Class({},null,bv);bv.New=bE.Ctor(function(bI){bv.New$1.call(this,"The operation was canceled.",null,bI);},bv);bv.New$1=bE.Ctor(function(bI,bJ,bK){this.message=bI;this.inner=bJ;this.ct=bK;},bv);bw.$cctor=function(){bw.$cctor=a.ignore;bw.Empty={$:0};};bx.Create=function(bI){return bB.New(false,bI,bx.forceLazy);};bx.forceLazy=function(){var bI;bI=this.v();this.c=true;this.v=bI;this.f=bx.cachedLazy;return bI;};bx.cachedLazy=function(){return this.v;};by.DocChildren=function(bI){var bJ;function bK(bL){if(bL!=null&&bL.$==2)bK(bL.$0.Current);else if(bL!=null&&bL.$==1)bJ.push(bL.$0.El);else if(bL==null);else if(bL!=null&&bL.$==5)bJ.push(bL.$0);else if(bL!=null&&bL.$==4)bJ.push(bL.$0.Text);else if(bL!=null&&bL.$==6)o.iter(function(bM){if(bM.constructor===L)bK(bM);else bJ.push(bM);},bL.$0.Els);else{bK(bL.$0);bK(bL.$1);}}bJ=[];bK(bI.Children);return{$:0,$0:_6.ofSeqNonCopying(bJ)};};by.Children=function(bI,bJ){var bK,bL,bM;if(bJ!=null&&bJ.$==1){bM=[];bK=bJ.$0[0].nextSibling;while(bK!==bJ.$0[1]){bM.push(bK);bK=bK.nextSibling;}return{$:0,$0:bM};}else return{$:0,$0:o.init(bI.childNodes.length,(bL=bI.childNodes,function(bN){return bL[bN];}))};};by.Except=function(bI,bJ){var bK;bK=bI.$0;return{$:0,$0:o.filter(function(bL){return o.forall(function(bM){return!(bL===bM);},bK);},bJ.$0)};};by.Iter=function(bI,bJ){o.iter(bI,bJ.$0);};bz.Clear=function(bI){bI.splice(0,o.length(bI));};bB.New=function(bI,bJ,bK){return{c:bI,v:bJ,f:bK};};bE.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined')
  IntelliFactory.Runtime.Start();
